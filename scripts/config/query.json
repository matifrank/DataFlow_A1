{
  "A1queries":[
    {"total": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, q.name AS sitio, COUNT(q.id) as 'total' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;"} ,
    {"monetized": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'monetizados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.monetized = 1 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"sent": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'enviados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.monetized = 1 AND l.rejected_zone = 0 AND l.i_with_data = 1 AND l.rejected_comercial = 0 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"gads": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'gads' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id INNER JOIN lead_variables lv ON lv.lead_id = l.id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND lv.code = 'utm' AND lv.`data` LIKE '%google%' AND lv.`data` LIKE '%cpc%' AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"gadsmonetized": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id,COUNT(q.id) as 'gads_monetizados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id INNER JOIN lead_variables lv ON lv.lead_id = l.id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.monetized = 1 AND lv.code = 'utm' AND lv.`data` LIKE '%google%' AND lv.`data` LIKE '%cpc%' AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"gadsent": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'gads_enviados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id INNER JOIN lead_variables lv ON lv.lead_id = l.id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.monetized = 1 AND l.rejected_zone = 0 AND l.i_with_data = 1 AND l.rejected_comercial = 0 AND lv.code = 'utm' AND lv.`data` LIKE '%google%' AND lv.`data` LIKE '%cpc%' AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"paid": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id,  COUNT(q.id) as 'paid' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.sem=1 AND l.source_id NOT IN (87,88) AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"paidmonetized": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'paid_monetizados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.sem=1 AND l.source_id NOT IN (87,88) AND l.monetized = 1 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"paidsent": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'paid_enviados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com'AND l.sem=1 AND l.source_id NOT IN (87,88) AND l.monetized = 1 AND l.rejected_zone = 0 AND l.i_with_data = 1 AND l.rejected_comercial = 0 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"emc": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'emc' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.source_id IN (9,11,12,13,14,15,16,18,24,25,26,27,28,29,32,39,42,43,46,52,53,54,76,78,79,80,81,82,83) AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"emcmonetized": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'emc_monetizados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.source_id IN (9,11,12,13,14,15,16,18,24,25,26,27,28,29,32,39,42,43,46,52,53,54,76,78,79,80,81,82,83) AND l.monetized = 1 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"emcsent": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'emc_enviados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.source_id IN (9,11,12,13,14,15,16,18,24,25,26,27,28,29,32,39,42,43,46,52,53,54,76,78,79,80,81,82,83)AND l.monetized = 1 AND l.rejected_zone = 0 AND l.i_with_data = 1 AND l.rejected_comercial = 0 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"muex": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'muex' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.source_id IN (87,88) AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"muexmonetized": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'muex_monetizados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.source_id IN (87,88) AND l.monetized = 1 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"muexsent": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'muex_enviados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND l.source_id IN (87,88) AND l.monetized = 1 AND l.rejected_zone = 0 AND l.i_with_data = 1 AND l.rejected_comercial = 0 AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" },
    {"reprocesados": "SELECT CONCAT(DATE_FORMAT(q.creation_date, '%Y-%m-01')) AS yearMonth, q.site_id, COUNT(q.id) as 'reprocesados' FROM ( SELECT k.* FROM ( SELECT l.id, l.site_id, l.creation_date, l.institution_id, u.phone, u.form_country_id, s.name FROM leads l INNER JOIN site_users u ON u.id = l.user_id INNER JOIN sites s ON s.id = l.site_id INNER JOIN lead_variables lv ON lv.lead_id = l.id WHERE u.email NOT LIKE '%@buscouniversidad.com.ar' AND u.email NOT LIKE '%@leaducate.com' AND u.email NOT LIKE '%@educaedu.com' AND lv.code = 'utm' AND lv.`data` LIKE '%reprocesado_manual%' AND l.creation_date BETWEEN @start_date AND @end_date GROUP BY l.institution_id, l.user_id ) k group by IF(k.phone is null, k.id, k.institution_id), IF(k.phone is null, k.id, k.phone), IF(k.phone is null, k.id, k.form_country_id) ) q WHERE q.creation_date BETWEEN @start_date AND @end_date GROUP BY yearMonth, q.site_id ORDER BY yearMonth ;" }
  ] 
}
